!function(i){void 0===window.soWidgets&&(window.soWidgets={}),window.soWidgets.icons=[],i(document).on("sowsetupformfield",".siteorigin-widget-field-type-icon",(function(e){var n=i(this),t=n.find(".siteorigin-widget-icon-selector"),o=t.find(".siteorigin-widget-icon-icon"),s=n.find(".siteorigin-widget-icon-selector-current"),d=n.find(".so-icon-remove"),a=n.find(".siteorigin-widget-icon-search");if(n.data("initialized"))return;s.find(".sow-icon-clear").remove(),s.on("click keyup",(function(i){("keyup"!=i.type||window.sowbForms.isEnter(i))&&(t.slideToggle(),a.val(""),c())})),d.on("click keyup",(function(i){i.preventDefault(),("keyup"!=i.type||window.sowbForms.isEnter(i))&&n.find(".siteorigin-widget-active").trigger("click")}));var c=function(){var e=a.val().toLowerCase();""===e?t.find(".siteorigin-widget-icon-icons-icon").show():t.find(".siteorigin-widget-icon-icons-icon").each((function(){var n=i(this),t=n.attr("data-value");-1===(t=t.replace(/-/," ")).indexOf(e)?n.hide():n.show()}))};a.on("keyup change",c);const r=()=>{!function(){const e=t.find("select.siteorigin-widget-icon-family"),n=e.val(),o=t.find(".siteorigin-widget-icon-family-styles").val();if(void 0===window.soWidgets.icons[n])return;let s=t.find(".siteorigin-widget-icon-family-styles");const d=window.soWidgets.icons[n];if(!d.hasOwnProperty("styles")||!d.styles)return s.off("change",g),void s.remove();s.off("change",g),s.remove();let a="";for(const i in d.styles)a+='<option value="'+i+'">'+d.styles[i]+"</option>";a&&(s=i('<select class="siteorigin-widget-icon-family-styles"></select>').append(a),e.after(s),o&&d.styles.hasOwnProperty(o)&&s.val(o)),s.on("change",g)}(),g()},g=()=>{const e=t.find("select.siteorigin-widget-icon-family").val(),n=t.find(".siteorigin-widget-icon-icons");if(void 0===window.soWidgets.icons[e])return void w();n.empty();const a=window.soWidgets.icons[e],r=a.icons;let g;for(var l in a.hasOwnProperty("styles")&&a.styles&&(g=t.find(".siteorigin-widget-icon-family-styles").val()),r){var f=r[l],v=f.hasOwnProperty("unicode")?f.unicode:f;if(!f.hasOwnProperty("styles")||-1!==f.styles.indexOf(g)){var y="sow-icon-"+e+(g?" "+g:""),u=e+(g?"-"+g:"")+"-"+l,p=i('<div data-sow-icon="'+v+'"></div>').attr("data-value",u).addClass(y).addClass("siteorigin-widget-icon-icons-icon").on("click keyup",(function(e){if("keyup"!=e.type||window.sowbForms.isEnter(e)){var a=i(this);a.hasClass("siteorigin-widget-active")?(a.removeClass("siteorigin-widget-active"),o.val(""),s.find("span").hide(),d.hide()):(n.find(".siteorigin-widget-icon-icons-icon").removeClass("siteorigin-widget-active"),a.addClass("siteorigin-widget-active"),o.val(a.data("value")),s.find("span").show().attr("data-sow-icon",a.attr("data-sow-icon")).attr("class","").addClass(y),d.show()),o.trigger("change",{isRendering:!0}),t.slideUp()}}));n.append(p),o.val()===u&&(s.find("span").show().attr("data-sow-icon",p.attr("data-sow-icon")).attr("class","").addClass(y),p.addClass("siteorigin-widget-active"))}}n.prepend(n.find(".siteorigin-widget-active")),c()},l=(e,n)=>{i("#siteorigin-widget-font-"+e).length||i("<link rel='stylesheet' type='text/css' />").attr("id","siteorigin-widget-font-"+e).attr("href",encodeURI(n)).appendTo("head")},w=()=>{const e=t.find("select.siteorigin-widget-icon-family").val();if(void 0===e||""===e)return;if(void 0!==window.soWidgets.icons[e])return void r();const n=t.find('select.siteorigin-widget-icon-family option[value="'+e+'"]');if(n.attr("data-icons")){const i=JSON.parse(n.attr("data-icons"));return window.soWidgets.icons[e]=i,l(e,i.style_uri),void r()}const o=t.find(".siteorigin-widget-icon-icons");o.addClass("loading"),i.getJSON(soWidgets.ajaxurl,{action:"siteorigin_widgets_get_icons",family:e},i=>{window.soWidgets.icons[e]=i,l(e,i.style_uri),r(),o.removeClass("loading")})};w(),t.find("select.siteorigin-widget-icon-family").on("change",(function(){t.find(".siteorigin-widget-icon-icons").empty(),r()})),o.on("change",(function(i,e){e&&e.isRendering||r()})),n.data("initialized",!0)}))}(jQuery);